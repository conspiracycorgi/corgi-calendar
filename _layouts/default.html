<!DOCTYPE html>
<html lang="{{ site.lang | default: 'en' }}">
{% include head.html %}
<body>
  <a class="skip-link" href="#main-content">Skip to content</a>
  
  <header class="site-header">
    <div class="container">
      <div class="site-branding">
        <a href="{{ site.baseurl }}/" class="site-logo">
          <span class="visually-hidden">{{ site.title }}</span>
          <!-- You can add a logo image here -->
        </a>
      </div>
      
      <nav class="site-navigation" aria-label="Main Navigation">
        <ul>
          <li><a href="{{ site.baseurl }}/" {% if page.url == '/' %}aria-current="page"{% endif %}>Home</a></li>
          <li><a href="{{ site.baseurl }}/about/" {% if page.url == '/about/' %}aria-current="page"{% endif %}>About</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main id="main-content">
    {{ content }}
  </main>

  {% include footer.html %}
  {% include structured-data.html %}
  
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      // Constants and configuration
      const START_DATE = new Date(2025, 2, 29); // March 29, 2025
      let currentDate = new Date(START_DATE);

      // Day images for each day of the week
      const dayImages = [
        {
          day: "Sat",
          image: "{{ site.baseurl }}/assets/images/saturday corgi.png"
        },
        {
          day: "Sun",
          image: "{{ site.baseurl }}/assets/images/sunday corgi.png"
        },
        {
          day: "Mon",
          image: "{{ site.baseurl }}/assets/images/monday corgi.png"
        },
        {
          day: "Tue",
          image: "{{ site.baseurl }}/assets/images/tuesday corgi.png"
        },
        {
          day: "Wed",
          image: "{{ site.baseurl }}/assets/images/wednesday corgi.png"
        },
        {
          day: "Thu",
          image: "{{ site.baseurl }}/assets/images/thursday corgi.png"
        },
        {
          day: "Fri",
          image: "{{ site.baseurl }}/assets/images/friday corgi.png"
        }
      ];

      // DOM elements
      const prevMonthButton = document.getElementById("prev-month");
      const nextMonthButton = document.getElementById("next-month");
      const lunarMonthYearElement = document.getElementById("lunar-month-year");
      const dayHeadersContainer = document.getElementById("day-headers");
      const calendarDaysContainer = document.getElementById("calendar-days");

      // Event listeners
      prevMonthButton.addEventListener("click", handlePrevMonth);
      nextMonthButton.addEventListener("click", handleNextMonth);

      // Initialize the calendar
      renderDayHeaders();
      renderCalendar();

      // Functions
      function handlePrevMonth() {
        currentDate = addDays(currentDate, -28);
        renderCalendar();
      }

      function handleNextMonth() {
        currentDate = addDays(currentDate, 28);
        renderCalendar();
      }

      function renderDayHeaders() {
        dayHeadersContainer.innerHTML = "";

        dayImages.forEach((dayInfo) => {
          const headerElement = document.createElement("div");
          headerElement.className = "day-header";
          headerElement.innerHTML = `
            <img src="${dayInfo.image}" alt="${dayInfo.day} Corgi" class="day-header-image">
            <div class="day-name">${dayInfo.day}</div>
          `;
          dayHeadersContainer.appendChild(headerElement);
        });
      }

      function renderCalendar() {
        // Update lunar month and year
        const lunarMonthYear = getLunarMonthYear(currentDate);
        lunarMonthYearElement.textContent = lunarMonthYear;

        // Clear and render calendar days
        calendarDaysContainer.innerHTML = "";

        const weekStart = startOfWeek(currentDate);

        for (let i = 0; i < 28; i++) {
          const currentDay = addDays(weekStart, i);
          const lunarDay = (i % 28) + 1;

          const dayElement = createCalendarDay(currentDay, lunarDay);
          calendarDaysContainer.appendChild(dayElement);
        }
      }

      function createCalendarDay(gregorianDate, lunarDay) {
        // Determine if this is a special moon day
        const isSpecialMoonDay = lunarDay === 1 || lunarDay === 8 || lunarDay === 15 || lunarDay === 22;

        // Get corgi mood and activity suggestion
        const corgiMood = getCorgiMood(lunarDay);
        const activitySuggestion = getActivitySuggestion(lunarDay);

        // Get moon phase
        const moonPhase = getMoonPhase(lunarDay);
        const moonPhaseName = getMoonPhaseName(lunarDay);

        // Create day element
        const dayElement = document.createElement("div");
        dayElement.className = `calendar-day ${isSpecialMoonDay ? "special-moon-day" : ""}`;

        // Add hover event for non-special days to show activity
        if (!isSpecialMoonDay) {
          dayElement.addEventListener("mouseenter", function() {
            const activityElement = this.querySelector(".activity-suggestion");
            if (activityElement) {
              activityElement.style.opacity = "1";
            }
          });

          dayElement.addEventListener("mouseleave", function() {
            const activityElement = this.querySelector(".activity-suggestion");
            if (activityElement) {
              activityElement.style.opacity = "0";
            }
          });
        }

        dayElement.innerHTML = `
          <!-- Day header with dates -->
          <div class="day-date-header">
            <div class="gregorian-date">
              <span class="weekday">${formatDate(gregorianDate, "EEE")}</span>
              <span class="day-number">G${formatDate(gregorianDate, "d")}</span>
            </div>
            <div class="lunar-date">
              <span class="month-name">${formatDate(gregorianDate, "MMM")}</span>
              <span class="lunar-day">L${lunarDay}</span>
            </div>
          </div>

          <!-- Day content -->
          <div class="day-content">
            <!-- Corgi mood -->
            <div class="mood-section">
              <div class="section-label">Corgi Mood</div>
              <div class="mood-text">${corgiMood}</div>
            </div>

            <!-- Activity suggestion -->
            <div class="activity-suggestion" style="opacity: ${isSpecialMoonDay ? '1' : '0'}">
              <div class="section-label">Activity</div>
              <div class="activity-text">${activitySuggestion}</div>
            </div>

            <!-- Moon phase -->
            <div class="moon-phase">
              <div class="moon-phase-inner" title="${moonPhaseName}">
                <span class="moon-emoji ${isSpecialMoonDay ? 'animate-wiggle' : ''}" aria-label="${moonPhaseName}">${moonPhase}</span>
              </div>
            </div>
          </div>

          <!-- Special indicator -->
          ${isSpecialMoonDay ? '<div class="special-indicator" aria-hidden="true"></div>' : ''}
        `;

        return dayElement;
      }

      // Helper functions
      function getLunarMonthYear(date) {
        const daysSinceStart = Math.floor((date.getTime() - START_DATE.getTime()) / (1000 * 60 * 60 * 24));
        const lunarMonth = (Math.floor(daysSinceStart / 28) % 13) + 1;
        const lunarYear = Math.floor(daysSinceStart / (28 * 13)) + 1;
        return `Corgi Month ${lunarMonth}, Year ${lunarYear}`;
      }

      function getMoonPhase(day) {
        if (day === 1) return "ðŸŒ‘"; // New Moon
        if (day < 8) return "ðŸŒ’"; // Waxing Crescent
        if (day === 8) return "ðŸŒ“"; // First Quarter
        if (day < 15) return "ðŸŒ”"; // Waxing Gibbous
        if (day === 15) return "ðŸŒ•"; // Full Moon
        if (day < 22) return "ðŸŒ–"; // Waning Gibbous
        if (day === 22) return "ðŸŒ—"; // Last Quarter
        return "ðŸŒ˜"; // Waning Crescent
      }

      function getMoonPhaseName(day) {
        if (day === 1) return "New Moon"; 
        if (day < 8) return "Waxing Crescent"; 
        if (day === 8) return "First Quarter"; 
        if (day < 15) return "Waxing Gibbous"; 
        if (day === 15) return "Full Moon"; 
        if (day < 22) return "Waning Gibbous"; 
        if (day === 22) return "Last Quarter"; 
        return "Waning Crescent"; 
      }

      // Enhanced corgi mood function with more variations
      function getCorgiMood(day) {
        // Define mood categories based on lunar phases
        const newMoonMoods = [
          "Adventurous & Bold",
          "Excitedly Curious",
          "Ready to Explore",
          "Boundlessly Energetic",
          "Playfully Mischievous"
        ];

        const waxingCrescentMoods = [
          "Energetically Hopeful",
          "Bright & Bouncy",
          "Eagerly Attentive",
          "Spirited & Lively",
          "Cheerfully Active"
        ];

        const firstQuarterMoods = [
          "Playfully Social",
          "Enthusiastically Engaged",
          "Joyfully Interactive",
          "Happily Frisky",
          "Delightfully Animated"
        ];

        const waxingGibbousMoods = [
          "Curiously Inquisitive",
          "Actively Exploring",
          "Intently Focused",
          "Keenly Observant",
          "Thoughtfully Engaged"
        ];

        const fullMoonMoods = [
          "Peacefully Relaxed",
          "Contentedly Calm",
          "Serenely Balanced",
          "Blissfully Tranquil",
          "Harmoniously Centered"
        ];

        const waningGibbousMoods = [
          "Dreamily Reflective",
          "Softly Contemplative",
          "Gently Pensive",
          "Quietly Thoughtful",
          "Calmly Introspective"
        ];

        const lastQuarterMoods = [
          "Thoughtfully Wise",
          "Insightfully Calm",
          "Deeply Observant",
          "Mindfully Present",
          "Sagely Perceptive"
        ];

        const waningCrescentMoods = [
          "Restfully Serene",
          "Peacefully Quiet",
          "Gently Recharging",
          "Softly Recuperating",
          "Calmly Renewing"
        ];

        // Get a random mood from the appropriate category based on lunar day
        const getRandomMood = (moodArray) => {
          const randomIndex = Math.floor(Math.random() * moodArray.length);
          return moodArray[randomIndex];
        };

        // Return a mood based on the lunar day
        if (day === 1) return getRandomMood(newMoonMoods);
        if (day < 8) return getRandomMood(waxingCrescentMoods);
        if (day === 8) return getRandomMood(firstQuarterMoods);
        if (day < 15) return getRandomMood(waxingGibbousMoods);
        if (day === 15) return getRandomMood(fullMoonMoods);
        if (day < 22) return getRandomMood(waningGibbousMoods);
        if (day === 22) return getRandomMood(lastQuarterMoods);
        return getRandomMood(waningCrescentMoods);
      }

      // Enhanced activity suggestions with more variations
      function getActivitySuggestion(day) {
        // Define activity categories based on lunar phases
        const newMoonActivities = [
          "Try a new walking route",
          "Explore a new park",
          "Introduce a new toy",
          "Visit new friends",
          "Start a training challenge"
        ];

        const waxingCrescentActivities = [
          "Fetch games with variety",
          "Energetic play sessions",
          "Morning adventure walks",
          "Interactive puzzle toys",
          "Backyard obstacle course"
        ];

        const firstQuarterActivities = [
          "Agility training fun",
          "Social playdates",
          "Frisbee in the park",
          "Swimming adventures",
          "Trick training sessions"
        ];

        const waxingGibbousActivities = [
          "Hide and seek games",
          "Scent work activities",
          "Moderate hikes",
          "Toy rotation day",
          "Enrichment activities"
        ];

        const fullMoonActivities = [
          "Gentle cuddle sessions",
          "Relaxing brushing time",
          "Calm evening walks",
          "Peaceful bonding time",
          "Soothing music therapy"
        ];

        const waningGibbousActivities = [
          "Relaxing massage time",
          "Gentle stretching",
          "Quiet garden time",
          "Slow-paced walks",
          "Calming chew toys"
        ];

        const lastQuarterActivities = [
          "Quiet play time",
          "Mental stimulation games",
          "Gentle training review",
          "Moderate exercise",
          "Balanced rest & play"
        ];

        const waningCrescentActivities = [
          "Short, calm walks",
          "Restful nap times",
          "Gentle indoor games",
          "Quiet companionship",
          "Cozy blanket time"
        ];

        // Get a random activity from the appropriate category
        const getRandomActivity = (activityArray) => {
          const randomIndex = Math.floor(Math.random() * activityArray.length);
          return activityArray[randomIndex];
        };

        // Return an activity based on the lunar day
        if (day === 1) return getRandomActivity(newMoonActivities);
        if (day < 8) return getRandomActivity(waxingCrescentActivities);
        if (day === 8) return getRandomActivity(firstQuarterActivities);
        if (day < 15) return getRandomActivity(waxingGibbousActivities);
        if (day === 15) return getRandomActivity(fullMoonActivities);
        if (day < 22) return getRandomActivity(waningGibbousActivities);
        if (day === 22) return getRandomActivity(lastQuarterActivities);
        return getRandomActivity(waningCrescentActivities);
      }

      // Date utility functions
      function addDays(date, days) {
        const result = new Date(date);
        result.setDate(result.getDate() + days);
        return result;
      }

      function startOfWeek(date, options = { weekStartsOn: 6 }) {
        const result = new Date(date);
        const day = result.getDay();
        const diff = (day < options.weekStartsOn ? 7 : 0) + day - options.weekStartsOn;
        result.setDate(result.getDate() - diff);
        return result;
      }

      function formatDate(date, format) {
        const d = new Date(date);

        // Simple date formatter
        switch (format) {
          case "d":
            return d.getDate();
          case "EEE":
            return ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"][d.getDay()];
          case "MMM":
            return ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"][d.getMonth()];
          default:
            return d.toString();
        }
      }
    });
  </script>
</body>
</html>

